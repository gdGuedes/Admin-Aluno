<?php include("conexao.php"); ?>
<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>

<div class="container">
	<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" width="71.6146mm" height="128.764mm" version="1.1" style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
viewBox="0 0 3081 5539"
 xmlns:xlink="http://www.w3.org/1999/xlink">
 <defs>
  <style type="text/css">
   <![CDATA[
    .fil1 {fill:#FEFEFE}
    .fil0 {fill:#373435}
   ]]>
  </style>
 </defs>
 <g id="Camada_x0020_1">
  <metadata id="CorelCorpID_0Corel-Layer"/>
  <rect class="fil0" width="3081" height="5539"/>
  <path class="fil1" d="M242 122l489 0 0 1154 -637 0 0 -990 148 -164zm-19 1093l379 0 0 -26 -379 0 0 26zm0 -137l379 0 0 -26 -379 0 0 26zm0 46l379 0 0 -27 -379 0 0 27zm0 46l379 0 0 -27 -379 0 0 27zm-38 -577c17,0 30,19 30,42 0,23 -13,41 -30,41 -17,0 -30,-18 -30,-41 0,-23 13,-42 30,-42z"/>
  <path class="fil1" d="M242 1412l489 0 0 1154 -637 0 0 -991 148 -163zm-19 1093l379 0 0 -27 -379 0 0 27zm0 -137l379 0 0 -26 -379 0 0 26zm0 46l379 0 0 -27 -379 0 0 27zm0 46l379 0 0 -27 -379 0 0 27zm-38 -577c17,0 30,18 30,42 0,23 -13,41 -30,41 -17,0 -30,-18 -30,-41 0,-24 13,-42 30,-42z"/>
  <path class="fil1" d="M242 2702l489 0 0 1154 -637 0 0 -991 148 -163zm-19 1093l379 0 0 -27 -379 0 0 27zm0 -137l379 0 0 -26 -379 0 0 26zm0 46l379 0 0 -27 -379 0 0 27zm0 45l379 0 0 -26 -379 0 0 26zm-38 -576c17,0 30,18 30,42 0,23 -13,41 -30,41 -17,0 -30,-18 -30,-41 0,-24 13,-42 30,-42z"/>
  <path class="fil1" d="M242 3992l489 0 0 1154 -637 0 0 -991 148 -163zm-19 1093l379 0 0 -27 -379 0 0 27zm0 -137l379 0 0 -26 -379 0 0 26zm0 46l379 0 0 -27 -379 0 0 27zm0 45l379 0 0 -26 -379 0 0 26zm-38 -576c17,0 30,18 30,41 0,24 -13,42 -30,42 -17,0 -30,-18 -30,-42 0,-23 13,-41 30,-41z"/>
  <path class="fil1" d="M989 122l490 0 0 1154 -638 0 0 -990 148 -164zm-19 1093l380 0 0 -26 -380 0 0 26zm0 -137l380 0 0 -26 -380 0 0 26zm0 46l380 0 0 -27 -380 0 0 27zm0 46l380 0 0 -27 -380 0 0 27zm-38 -577c17,0 31,19 31,42 0,23 -14,41 -31,41 -16,0 -30,-18 -30,-41 0,-23 14,-42 30,-42z"/>
  <path class="fil1" d="M989 1412l490 0 0 1154 -638 0 0 -991 148 -163zm-19 1093l380 0 0 -27 -380 0 0 27zm0 -137l380 0 0 -26 -380 0 0 26zm0 46l380 0 0 -27 -380 0 0 27zm0 46l380 0 0 -27 -380 0 0 27zm-38 -577c17,0 31,18 31,42 0,23 -14,41 -31,41 -16,0 -30,-18 -30,-41 0,-24 14,-42 30,-42z"/>
  <path class="fil1" d="M989 2702l490 0 0 1154 -638 0 0 -991 148 -163zm-19 1093l380 0 0 -27 -380 0 0 27zm0 -137l380 0 0 -26 -380 0 0 26zm0 46l380 0 0 -27 -380 0 0 27zm0 45l380 0 0 -26 -380 0 0 26zm-38 -576c17,0 31,18 31,42 0,23 -14,41 -31,41 -16,0 -30,-18 -30,-41 0,-24 14,-42 30,-42z"/>
  <path class="fil1" d="M989 3992l490 0 0 1154 -638 0 0 -991 148 -163zm-19 1093l380 0 0 -27 -380 0 0 27zm0 -137l380 0 0 -26 -380 0 0 26zm0 46l380 0 0 -27 -380 0 0 27zm0 45l380 0 0 -26 -380 0 0 26zm-38 -576c17,0 31,18 31,41 0,24 -14,42 -31,42 -16,0 -30,-18 -30,-42 0,-23 14,-41 30,-41z"/>
  <path class="fil1" d="M1737 122l489 0 0 1154 -637 0 0 -990 148 -164zm-19 1093l379 0 0 -26 -379 0 0 26zm0 -137l379 0 0 -26 -379 0 0 26zm0 46l379 0 0 -27 -379 0 0 27zm0 46l379 0 0 -27 -379 0 0 27zm-38 -577c17,0 30,19 30,42 0,23 -13,41 -30,41 -17,0 -31,-18 -31,-41 0,-23 14,-42 31,-42z"/>
  <path class="fil1" d="M1737 1412l489 0 0 1154 -637 0 0 -991 148 -163zm-19 1093l379 0 0 -27 -379 0 0 27zm0 -137l379 0 0 -26 -379 0 0 26zm0 46l379 0 0 -27 -379 0 0 27zm0 46l379 0 0 -27 -379 0 0 27zm-38 -577c17,0 30,18 30,42 0,23 -13,41 -30,41 -17,0 -31,-18 -31,-41 0,-24 14,-42 31,-42z"/>
  <path class="fil1" d="M1737 2702l489 0 0 1154 -637 0 0 -991 148 -163zm-19 1093l379 0 0 -27 -379 0 0 27zm0 -137l379 0 0 -26 -379 0 0 26zm0 46l379 0 0 -27 -379 0 0 27zm0 45l379 0 0 -26 -379 0 0 26zm-38 -576c17,0 30,18 30,42 0,23 -13,41 -30,41 -17,0 -31,-18 -31,-41 0,-24 14,-42 31,-42z"/>
  <path class="fil1" d="M1737 3992l489 0 0 1154 -637 0 0 -991 148 -163zm-19 1093l379 0 0 -27 -379 0 0 27zm0 -137l379 0 0 -26 -379 0 0 26zm0 46l379 0 0 -27 -379 0 0 27zm0 45l379 0 0 -26 -379 0 0 26zm-38 -576c17,0 30,18 30,41 0,24 -13,42 -30,42 -17,0 -31,-18 -31,-42 0,-23 14,-41 31,-41z"/>
  <path class="fil1" d="M2484 122l490 0 0 1154 -638 0 0 -990 148 -164zm-19 1093l380 0 0 -26 -380 0 0 26zm0 -137l380 0 0 -26 -380 0 0 26zm0 46l380 0 0 -27 -380 0 0 27zm0 46l380 0 0 -27 -380 0 0 27zm-38 -577c17,0 31,19 31,42 0,23 -14,41 -31,41 -16,0 -30,-18 -30,-41 0,-23 14,-42 30,-42z"/>
  <path class="fil1" d="M2484 1412l490 0 0 1154 -638 0 0 -991 148 -163zm-19 1093l380 0 0 -27 -380 0 0 27zm0 -137l380 0 0 -26 -380 0 0 26zm0 46l380 0 0 -27 -380 0 0 27zm0 46l380 0 0 -27 -380 0 0 27zm-38 -577c17,0 31,18 31,42 0,23 -14,41 -31,41 -16,0 -30,-18 -30,-41 0,-24 14,-42 30,-42z"/>
  <path class="fil1" d="M2484 2702l490 0 0 1154 -638 0 0 -991 148 -163zm-19 1093l380 0 0 -27 -380 0 0 27zm0 -137l380 0 0 -26 -380 0 0 26zm0 46l380 0 0 -27 -380 0 0 27zm0 45l380 0 0 -26 -380 0 0 26zm-38 -576c17,0 31,18 31,42 0,23 -14,41 -31,41 -16,0 -30,-18 -30,-41 0,-24 14,-42 30,-42z"/>
  <path class="fil1" d="M2484 3992l490 0 0 1154 -638 0 0 -991 148 -163zm-19 1093l380 0 0 -27 -380 0 0 27zm0 -137l380 0 0 -26 -380 0 0 26zm0 46l380 0 0 -27 -380 0 0 27zm0 45l380 0 0 -26 -380 0 0 26zm-38 -576c17,0 31,18 31,41 0,24 -14,42 -31,42 -16,0 -30,-18 -30,-42 0,-23 14,-41 30,-41z"/>
 </g>
</svg>
</div>


<script>
var portas = document.querySelectorAll('.fil1');
Limpar(-1);
function Limpar(i){	
	<?php 
		$t = armariosLoad();

		while($armario = $t->fetch_array()){
			
			if($armario['status'] =="ocupado"){
				echo 'portas['.($armario['cd']-1).'].style.fill="yellow";'.PHP_EOL;
				echo 'portas['.($armario['cd']-1).'].setAttribute("valor","'.($armario['cd']).'");'.PHP_EOL;

			}
			else if($armario['status'] == "vencido"){
				echo 'portas['.($armario['cd']-1).'].style.fill="red";'.PHP_EOL;
				echo 'portas['.($armario['cd']-1).'].setAttribute("valor","'.($armario['cd']).'");'.PHP_EOL;
			}
			else{
				echo 'if('.($armario['cd']-1).' != i){';
				echo 'portas['.($armario['cd']-1).'].style.fill="";'.PHP_EOL;
				echo 'portas['.($armario['cd']-1).'].setAttribute("valor","'.($armario['cd']).'");'.PHP_EOL;
				echo '}';
			}
			
			echo 'portas['.($armario['cd']-1).'].setAttribute("status","'.$armario['status'].'");'.PHP_EOL;
			
		}
	?>		
}

for(i=0; i<portas.length; i++){
	portas[i].addEventListener('click', function(){
		//limpa outros cliques
		Limpar(i);
		p(i);
		
		if(this.getAttribute('status') == "p"){
			console.log("jÃ¡ tem");
			this.style.fill="white"; //cor ao clicar

			this.setAttribute("status","");

			localStorage.removeItem('porta');
		}
		else if(this.getAttribute('status') == ""){				
			this.style.fill="green"; //cor ao clicar

			this.setAttribute("status","p");

			localStorage.setItem('porta', this.getAttribute('valor'));
		}

	});

}

function p(porta){
	if(localStorage.porta == porta){
		portas[porta-1].style.fill="green";
		portas[porta-1].setAttribute("valor",porta);
	}
}


</script>
</body>
</html>